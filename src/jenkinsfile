pipeline {
    agent any

    options {
        buildDiscarder(logRotator(numToKeepStr: '10'))
    }

    stages {
        stage('Hello') {
            steps {
                echo 'Hello World'
                echo 'printenv'
            }
        }
        stage('Test') {
            steps {
                echo "Running on ${env.BUILD_NUMBER} on ${env.JENKINS_URL}",
                echo "git_branch:---->${env.GIT_BRANCH}",
                echo "Job '${JOB_NAME}' (${BUILD_NUMBER}) is waiting for input",
                echo "Please go to ${BUILD_URL} and verify the build"

            }
        }
    }
    post {
            always {
                echo 'I will always say Hello!'
            }
            aborted {
                echo 'I was aborted'
            }
            failure {
                mail to: 'cgsnd5669@163.com',
                subject: "Failed Pipeline: ${currentBuild.fullDisplayName}",
                body: "Something is wrong with ${env.BUILD_URL}"
            }
            success {
                echo 'post success !!!'
            }
        }
}
